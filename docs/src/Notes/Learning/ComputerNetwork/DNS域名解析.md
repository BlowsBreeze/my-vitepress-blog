---
updateTime: "2024-12-21 14:35"
desc: "计算机网络，DNS域名解析"
tags: "计算机网络"
---
# DNS域名解析

DNS（Domain Name System）域名解析是将域名转换为 IP 地址的过程

## 域名结构

DNS 中的域名都是用句点来分隔的，比如`www.server.com`，这里的句点代表了不同层次之间的界限。（www访问主站）

在域名中，**越靠右的位置表示其层级越高**

根域是在最顶层(com后的`.`其实表示根域，不过是隐藏的，隐藏存在)，它的下一层就是 com 顶级域，在线是 server.com

- 根 DNS 服务器
- 顶级域 DNS 服务器（com）
- 权威 DNS 服务器（server.com）

## DNS域名解析的工作流程

浏览器首先看一下 **自己的缓存** 里有没有，如果没有就向 **操作系统的缓存** 要，还没有就 **检查本机域名解析文件 hosts**，如果还没有就向 **DNS服务器进行查询**，查询的过程如下：

1. 客户端首先会发出一个 DNS 请求，问`www.server.com`的IP是啥，并发给本地 DNS 服务器（也就是客户端的 TCP/IP 设置中填写的 DNS 服务器地址）
2. 本地域名服务器收到客户端的请求后，如果缓存里的表格能找到`www.server.com`，则它直接返回 IP 地址。如果没有，本地 DNS 会去问它的根域名服务器："老大，能告诉我`www.server.com`的 IP 地址吗？" 根域名服务器是最高层次的，他不直接用于域名解析，但能指明一条道路

## 移动端最简单排查 DNS 错误的方法

**在手机上切换WIFI和4G网络**可以简单的验证DNS错误是否会导致网络连接问题。

通常，当我们连接到一个新的WIFI网络时，DNS设置会被自动更新，这意味着如果我们之前的DNS配置有误，它可能会被自动纠正。

相反，4G网络一般使用ISP提供的默认DNS设置，这可以用来确定如果出现网络连接问题，是否与特定DNS设置有关。



## 子域名/二级域名

子域名指的是一个域名下的二级域名，也就是说，它是 **主域名的一个分支**。

例如，对于域名example.com，子域名可以是`www.example.com`、`blog.example.com`、`shop.example.com`等

子域名可以让网站的管理变得更加灵活，可以根据需要将不同的服务或应用程序部署到不同的子域名上，从而 **提高网站的可扩展性和可维护性**

例如，可以将静态资源放在cdn.example.com，将API服务放在api.example.com

另外，子域名也可以用来区分不同的业务或品牌。例如：电商网站可以将男装商品放在man.example.com上，女装放在woman.example.com上

在DNS解析时，子域名会被解析为主域名的一部分，这样可以将不同的服务或应用程序映射到不同的IP地址上。

在Web服务器，可以配置虚拟主机来处理来自不同子域名的请求，从而提供不同的服务或应用程序

需要注意的是，过多的子域名可能会导致管理复杂度增加，同时也会增加DNS解析的时间

# 浏览器从输入URL到解析页面的过程

1. URL解析
2. 查找缓存
3. DNS域名解析
4. TCP三次握手建立连接
5. 发送HTTP请求
6. 服务器处理请求并返回报文
7. 浏览器解析渲染页面
8. TCP四次挥手断开连接